# 文件拖拽功能使用指南

## 🎯 功能概述

文件拖拽功能让用户可以通过拖拽来重新组织文件和文件夹结构，提供直观的文件管理体验。

## ✨ 主要特性

### 🗂️ 支持的拖拽操作
- **文件到文件夹**：将文件拖拽到文件夹中
- **文件夹到文件夹**：将文件夹拖拽到另一个文件夹中
- **移动到根目录**：将文件或文件夹拖拽到根目录

### 🎨 视觉反馈
- **拖拽指示**：拖拽时文件/文件夹变为半透明并轻微旋转
- **放置提示**：文件夹在可接受拖拽时显示蓝色虚线边框
- **根目录提示**：拖拽到侧边栏空白区域时显示"移动到根目录"提示
- **自动展开**：拖拽悬停在文件夹上0.8秒后自动展开

### 🛡️ 安全机制
- **循环检测**：防止将文件夹拖拽到自己的子文件夹中
- **自我保护**：不能将文件拖拽到自己身上
- **权限验证**：确保用户有权限进行文件移动操作

## 📖 使用方法

### 1. 拖拽文件到文件夹

1. **选择文件**：在左侧文件树中找到要移动的文件
2. **开始拖拽**：按住鼠标左键并拖拽文件
3. **选择目标**：将文件拖拽到目标文件夹上
4. **确认放置**：文件夹显示蓝色边框时释放鼠标

### 2. 拖拽文件夹

1. **选择文件夹**：点击并拖拽要移动的文件夹
2. **目标选择**：拖拽到另一个文件夹或根目录
3. **自动展开**：悬停在文件夹上会自动展开显示子内容
4. **完成移动**：在合适位置释放鼠标完成移动

### 3. 移动到根目录

1. **拖拽文件/文件夹**：选择要移动的项目
2. **拖拽到空白区域**：将项目拖拽到侧边栏的空白区域
3. **根目录提示**：看到"移动到根目录"提示时释放鼠标
4. **完成移动**：文件/文件夹将移动到根目录

## 🎨 视觉指示说明

### 拖拽状态
- **半透明 + 旋转**：正在被拖拽的文件/文件夹
- **蓝色虚线边框**：可接受放置的文件夹
- **蓝色背景提示**：根目录放置区域

### 鼠标指针
- **抓取手型** (grab)：可拖拽状态
- **抓取中手型** (grabbing)：正在拖拽
- **移动箭头**：可放置状态
- **禁止符号**：不可放置状态

## 🔧 技术实现

### 拖拽服务 (DragDropService)
- **统一管理**：所有拖拽操作的中央控制器
- **状态跟踪**：跟踪拖拽源、目标和状态
- **安全检查**：验证拖拽操作的合法性

### 事件处理
- **dragstart**: 开始拖拽，设置拖拽数据
- **dragover**: 拖拽悬停，显示视觉反馈
- **dragenter**: 进入放置区域，显示放置提示
- **dragleave**: 离开放置区域，隐藏提示
- **drop**: 完成放置，执行文件移动

### 数据持久化
- **文件系统集成**：通过 FileSystemService 持久化移动操作
- **状态同步**：实时更新文件树显示
- **错误处理**：移动失败时的回滚和提示

## 💡 使用技巧

### 📁 文件夹组织
- **按项目分类**：创建项目文件夹，将相关文件拖拽进去
- **按类型分类**：创建文档、图片、代码等分类文件夹
- **临时整理**：使用拖拽快速整理杂乱的文件

### ⚡ 快速操作
- **批量移动**：先展开目标文件夹，然后逐个拖拽文件
- **层级调整**：通过拖拽调整文件夹的层级关系
- **快速归档**：将完成的文件拖拽到归档文件夹

### 🎯 最佳实践
- **清晰命名**：使用清晰的文件夹名称便于拖拽定位
- **合理层级**：避免过深的文件夹嵌套
- **及时整理**：定期使用拖拽功能整理文件结构

## ⚠️ 注意事项

### 🚫 限制条件
1. **循环移动**：不能将文件夹移动到自己的子文件夹中
2. **重名文件**：目标位置有同名文件时移动会失败
3. **权限限制**：只能移动有权限的文件和文件夹

### 🔍 故障排除
1. **拖拽无响应**：检查文件是否被其他程序占用
2. **移动失败**：查看控制台错误信息
3. **视觉异常**：刷新页面重置拖拽状态

### 💾 数据安全
1. **移动操作**：拖拽是移动操作，不是复制
2. **即时生效**：拖拽完成后立即保存到存储
3. **无撤销**：目前不支持拖拽操作的撤销

## 🔮 未来计划

- **多选拖拽**：支持选择多个文件一起拖拽
- **拖拽排序**：支持通过拖拽调整文件顺序
- **外部拖拽**：支持从系统文件管理器拖拽文件到编辑器
- **拖拽预览**：拖拽时显示文件内容预览
- **拖拽撤销**：支持拖拽操作的撤销功能

---

通过拖拽功能，你可以轻松地重新组织文件结构，让项目管理更加直观高效！ 🎯